{% extends 'layouts/base.html' %}
{% load static %}
{% block page_title %}Noticias{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/news.css' %}">
{% endblock %}

{% block content %}
<h1>Noticias</h1>

  <form class="mb-3" method="get">
    <input type="text" name="q" value="{{ q }}" class="form-control" placeholder="ğŸ” Buscar por tÃ­tulo de noticia">
  </form>

<!-- Grid de noticias -->
<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" id="news-grid">
  {% for n in news %}
  <div class="col news-card" data-tags="{% for t in n.tags.all %}tag-{{ t.id }} {% endfor %}">
    <div class="card card-smooth h-100">
    <div class="cover-wrapper position-relative">
        {% if n.cover_image %}
        <img src="{{ n.cover_image.url }}" alt="Portada de {{ n.title }}" class="news-cover">
        {% else %}
        <img src="{% static 'img/placeholder-16x9.jpg' %}" alt="Sin portada" class="news-cover">
        {% endif %}
        <a href="{% url 'news_detail_user' n.id %}"
        class="stretched-link"
        aria-label="Abrir detalle de {{ n.title }}"></a>
    </div>
    {# â¬†ï¸ SOLO LA PORTADA ES CLICABLE AL DETALLE â¬†ï¸ #}

      <div class="card-body">
        <h5 class="card-title line-clamp-2 mb-2">{{ n.title }}</h5>
        <hr class="my-4">

        <div class="text-muted mb-3" style="font-size:.9rem;">
          ğŸ•’ Hace {{ n.published_at|timesince }}
        </div>

        <div class="d-flex align-items-center gap-3">
          <button type="button"
                  class="btn btn-sm rounded-3 btn-like {% if n.my_liked %}btn-success {% else %}btn-outline-secondary{% endif %}"
                  data-url="{% url 'news_like_toggle' n.id %}"
                  aria-pressed="{{ n.my_liked|yesno:'true,false' }}">
            ğŸ‘ <span class="like-count">{{ n.like_count }}</span>
          </button>

          <span title="Comentarios">ğŸ’¬ 0</span>
          <a class="btn btn-sm btn-outline-primary" href="">Ver likes</a>
        </div>
      </div>

      <div class="card-footer bg-white">
        <a class="text-decoration-none" href="">
          Ver los 0 comentarios
        </a>
      </div>
    </div>
  </div>
  {% empty %}
  <div class="col">
    <div class="alert alert-light border">No hay noticias visibles aÃºn.</div>
  </div>
  {% endfor %}
</div>

{% endblock %}

{% block scripts %}
  <script src="{% static 'js/news.js' %}"></script>
{% endblock %}
