{% extends 'layouts/base.html' %}
{% block page_title %}Noticias{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2 class="mb-0">Noticias</h2>
  <a href="{% url 'news_create' %}" class="btn btn-primary">+ Nueva noticia</a>
</div>

<div class="card p-3">
  <form class="mb-3" method="get">
    <input type="text" name="q" value="{{ q }}" class="form-control" placeholder="🔍 Buscar por título de noticia">
  </form>

  <table class="table table-hover align-middle">
    <thead>
      <tr>
        <th>Título</th>
        <th>Tópicos</th>
        <th>Fecha</th>
        <th>Creador</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for noticia in news %}
        <tr>
          <td>
            <a href="{% url 'news_detail_admin' noticia.id %}">
              {{ noticia.title|truncatechars:80 }}
            </a>
          </td>
          <td>
            {% for tag in noticia.tags.all %}
              <span class="badge bg-secondary me-1">{{ tag.name }}</span>
            {% empty %}
              <span>-</span>
            {% endfor %}
          </td>
          <td>
            {% if noticia.publish_at %}
              {{ noticia.publish_at|date:"d/m/Y H:i" }}
            {% else %}
              {{ noticia.published_at|date:"d/m/Y H:i" }}
            {% endif %}
          </td>
          <td>{{ noticia.author|default:"—" }}</td>
          <td>
            <div class="dropdown">
              <a class="btn btn-link dropdown-toggle" data-bs-toggle="dropdown">⋮</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">Editar</a></li>
                <li><a class="dropdown-item text-danger" href="#">Eliminar</a></li>
              </ul>
            </div>
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="5" class="text-center">No hay noticias aún.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
