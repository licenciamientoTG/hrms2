{% extends 'layouts/base.html' %}
{% load static %}

{% block page_title %}Encuestas{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/forms.css' %}">
{% endblock %}

{% block content %}
<div class="container mt-4">
  <h1>Encuestas</h1>

  <!-- Barra de búsqueda -->
  <input type="text" id="formSearch" class="form-control search-bar" placeholder="Buscar encuesta...">

  <!-- Tabs -->
  <div class="tab-container mb-3">
    <div class="tab active" id="tab-disponibles">Disponibles</div>
    <div class="tab" id="tab-completados">Completadas</div>
  </div>

  <!-- ========= DISPONIBLES ========= -->
  <div id="contenedor-disponibles">
    <div class="form-list" id="list-disponibles">
      {% if available %}
        {% for s in available %}
        <div class="form-item mb-3" data-title="{{ s.title|lower }}">
          <i class="form-icon bi bi-clipboard-check"></i>
          <div class="form-name">
            {{ s.title }}
            {% if s.description %}
              <p class="muted-70">{{ s.description }}</p>
            {% endif %}
          </div>
          <div class="form-actions">
            <a href="{{ s.take_url }}" class="btn btn-outline-primary">Responder</a>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="form-item mb-3">
          <i class="form-icon bi bi-inbox"></i>
          <div class="form-name">No tienes encuestas disponibles.</div>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- ========= COMPLETADAS ========= -->
  <div id="contenedor-completados" style="display:none;">
    <div class="form-list" id="list-completados">
      {% if completed %}
        {% for s in completed %}
        <div class="form-item mb-3" data-title="{{ s.title|lower }}">
          <i class="form-icon bi bi-clipboard-check-fill"></i>
          <div class="form-name">
            {{ s.title }}
            <span class="badge bg-success ms-2">Completada</span>
          </div>
          <div class="form-actions">
            <a href="{{ s.take_url }}" class="btn btn-outline-primary">Ver</a>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="form-item mb-3">
          <i class="form-icon bi bi-check2-circle"></i>
          <div class="form-name">Aún no has completado encuestas.</div>
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/survey.js' %}"></script>
{% endblock %}
