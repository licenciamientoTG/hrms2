{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Cambiar contraseña</title>
  <link rel="stylesheet" href="{% static 'css/estilos.css' %}">
  <style>
    body {
      background: linear-gradient(to bottom, #f0f3f8, #ffffff);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      justify-content: center;
    }

    .header h1 {
      color: #1a4b96;
      font-size: 24px;
    }

    .login-container {
      background: white;
      border-radius: 15px;
      box-shadow: 1px 0px 20px rgb(0 0 0 / 51%);
      width: 100%;
      max-width: 800px;
      display: flex;
      overflow: hidden;
    }

    .logo-section {
      flex: 1;
      background: white;
      padding: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-section img {
      max-width: 80%;
      height: auto;
    }

    .form-section {
      flex: 1;
      background: #1a4b96;
      padding: 40px;
      color: white;
    }

    .form-section h2 {
      color: #A9CA48;
      margin-bottom: 10px;
    }

    .form-section p {
      margin-bottom: 30px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border: 1px solid #A9CA48;
      border-radius: 7px;
      background: #1a4b96;
      color: white;
    }

    .form-group input::placeholder {
      color: rgba(255, 255, 255, 0.7);
    }

    .submit-button {
      background: #A9CA48;
      border: none;
      padding: 10px;
      width: 100%;
      border-radius: 7px;
      font-size: larger;
      font-weight: 500;
      cursor: pointer;
      color: #1a4b96;
    }

    .submit-button:hover {
      background: #7bc5258f;
    }
    
    /* El contenedor ahora FINGE ser el input (tiene el borde y el color de fondo) */
    .password-container {
      display: flex;
      align-items: center;
      width: 100%;
      background: #1a4b96;       /* Fondo azul */
      border: 1px solid #A9CA48; /* Borde verde */
      border-radius: 7px;
      padding-right: 10px;       /* Espacio para el icono */
      transition: all 0.3s ease;
    }

    /* Efecto focus: cuando tocas dentro, se ilumina un poco más el borde (opcional) */
    .password-container:focus-within {
      box-shadow: 0 0 5px rgba(169, 202, 72, 0.5);
    }

    /* El input de Django: Lo hacemos transparente y sin bordes */
    .password-container input {
      border: none !important;      /* Quitamos su borde */
      background: transparent !important; /* Fondo transparente */
      outline: none !important;     /* Quitamos la línea de selección */
      width: 100%;
      color: white;
      padding: 12px;                /* Mismo padding original */
      box-shadow: none !important;
    }

    /* El botón del ojo */
    .toggle-password-btn {
      background: none;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 5px;
      color: rgba(255, 255, 255, 0.6);
      min-width: 40px; /* Asegura que sea fácil de cliquear */
    }

    .toggle-password-btn:hover {
      color: #A9CA48;
    }

  </style>
</head>
<body>
  <div class="header">
    <h1>HRMS</h1>
  </div>

  <div class="login-container">
    <div class="logo-section">
      <img src="{% static 'template/img/logos/LOGOTIPO.png' %}" alt="TotalGas Logo">
    </div>

    <div class="form-section">
        <h2>Cambiar contraseña</h2>
        <p>Por seguridad, es necesario que actualices tu contraseña por primera vez.</p>
        <p style="font-size: 13px; color: #e6e6e6; margin-top: -10px;">
            La contraseña debe tener al menos <strong>8 caracteres</strong>, incluir una <strong>mayúscula</strong>, un <strong>número</strong> y un <strong>carácter especial</strong>.
        </p>


<form method="post">
        {% csrf_token %}
        
        <div class="form-group">
          {{ form.old_password.label_tag }}
          <div class="password-container">
            {{ form.old_password }}
            <button type="button" class="toggle-password-btn" title="Mostrar contraseña">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            </button>
          </div>
          {{ form.old_password.errors }}
        </div>

        <div class="form-group">
          {{ form.new_password1.label_tag }}
          <div class="password-container">
            {{ form.new_password1 }}
            <button type="button" class="toggle-password-btn" title="Mostrar contraseña">
               <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            </button>
          </div>
          {{ form.new_password1.errors }}
        </div>

        <div class="form-group">
          {{ form.new_password2.label_tag }}
          <div class="password-container">
            {{ form.new_password2 }}
            <button type="button" class="toggle-password-btn" title="Mostrar contraseña">
               <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            </button>
          </div>
          {{ form.new_password2.errors }}
        </div>

        <button type="submit" class="submit-button">Actualizar contraseña</button>
      </form>
    </div>
  </div>
</body>
<script>
  const iconEye = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>`;
  const iconEyeOff = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>`;

  const toggleButtons = document.querySelectorAll('.toggle-password-btn');

  toggleButtons.forEach(btn => {
    btn.addEventListener('click', function() {
      const input = this.parentElement.querySelector('input');
      if (input) {
        const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
        input.setAttribute('type', type);
        
        if (type === 'text') {
          this.innerHTML = iconEyeOff;
          this.style.color = "#ffffff"; // Blanco cuando se ve
        } else {
          this.innerHTML = iconEye;
          this.style.color = "rgba(255, 255, 255, 0.6)"; // Tenue cuando oculto
        }
      }
    });
  });
</script>
</html>
